version: 2
jobs:
  Critical_Path_Test_Staging:
    docker:
      - image: circleci/openjdk:8u232-jdk-browsers
    steps:
      - checkout

        # Download and cache dependencies
        - restore_cache:
            keys:
              - v1-dependencies-{{ checksum "pom.xml" }}
              # fallback to using the latest cache if no exact match is found
              - v1-dependencies-

        - run: mvn dependency:go-offline

        - save_cache:
            paths:
              - ~/.m2
            key: v1-dependencies-{{ checksum "pom.xml" }}

      - run:
          name: Run Critical Path Tests
          command: |
            mvn clean verify -Dcucumber.options="--tags @smoke" -Dbrowser.instances=1